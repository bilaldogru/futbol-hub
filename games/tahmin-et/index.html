<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futbolcu Arena - GÃ¼nlÃ¼k Meydan Okuma</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <a href="../../index.html" class="back-home-btn">
        <i class="fa-solid fa-arrow-left"></i> <span class="btn-text">ANA MENÃœ</span>
    </a>
    <div class="bg-overlay"></div>
<body>

    <div class="bg-overlay"></div>

    <div id="login-modal" class="modal">
        <div class="modal-content">
            <h2>GÃœNLÃœK MEYDAN OKUMA</h2>
            <p>BugÃ¼nÃ¼n 10 futbolcusunu tahmin et, listeye adÄ±nÄ± yazdÄ±r!</p>
            <input type="text" id="username-input" placeholder="AdÄ±n veya Nickname..." maxlength="15">
            <button onclick="startDailyChallenge()">BAÅLA</button>
        </div>
    </div>

    <div class="main-layout blurred" id="game-wrapper">
        
        <div class="game-section">
            <div class="game-container">
                <header>
                    <div class="header-top">
                        <h1>FUTBOLCU ARENA</h1>
                        <div class="question-counter">SORU: <span id="q-count">1</span>/10</div>
                    </div>
                    
                    <div class="stats">
                        <div class="score-box current">
                            <span class="label">BU SORU</span>
                            <span id="current-score" class="value">100</span>
                        </div>
                        <div class="score-box total">
                            <span class="label">TOPLAM PUAN</span>
                            <span id="total-score" class="value">0</span>
                        </div>
                    </div>
                </header>

                <div class="hangman-container" id="hangman-area"></div>

                <div class="clues-wrapper">
                    <h3>Ä°PUÃ‡LARI</h3>
                    <div class="clues-container" id="clues-area"></div>
                </div>

                <div class="input-area">
                    <input type="text" id="guess-input" placeholder="Futbolcunun adÄ±..." autocomplete="off">
                    <button onclick="makeGuess()">TAHMÄ°N ET</button>
                </div>

                <div id="message-area" class="message hidden"></div>
                
                <button id="next-btn" class="hidden action-btn" onclick="nextQuestion()">SIRADAKÄ° SORU â–¶</button>
            </div>
        </div>

        <div class="sidebar">
            <div class="leaderboard-box">
                <h2>ğŸ† LÄ°DERLÄ°K TABLOSU</h2>
                <p class="date-label" id="date-display">16.02.2026</p>
                
                <ul id="leaderboard-list">
                    </ul>

                <div class="daily-info">
                    <p>Her gÃ¼n 00:00'da yenilenir.</p>
                    <p>Herkese aynÄ± 10 futbolcu sorulur.</p>
                </div>
            </div>
        </div>

    </div>

    <script src="script.js"></script>

    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, query, where, getDocs, updateDoc, doc, increment } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  // --- API KEYLERÄ°NÄ° BURAYA YAPIÅTIR ---
  const firebaseConfig = 
  {
     apiKey: "AIzaSyD62cMqFmtT_LYOQdyLEib3TlP2sDXVHUY",
    authDomain: "futbol-hub0.firebaseapp.com", 
    projectId: "futbol-hub0", storageBucket: "futbol-hub0.firebasestorage.app", 
    messagingSenderId: "995690857981", appId: "1:995690857981:web:01f199920e1c131cd04594", 
    measurementId: "G-7JT28VLCTE" 
    };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  window.saveScoreToFirebase = async (newScore, gameName) => {
    // 1. KullanÄ±cÄ± GiriÅŸ YapmÄ±ÅŸ mÄ±?
    const userStr = localStorage.getItem('firebaseUser');
    if (!userStr) {
      alert("PuanÄ±nÄ± biriktirmek iÃ§in ANA SAYFADAN giriÅŸ yapmalÄ±sÄ±n!");
      return;
    }
    const user = JSON.parse(userStr);

    try {
      // 2. Bu kullanÄ±cÄ± daha Ã¶nce puan almÄ±ÅŸ mÄ± kontrol et
      const scoresRef = collection(db, "scores");
      const q = query(scoresRef, where("email", "==", user.email));
      const querySnapshot = await getDocs(q);

      if (!querySnapshot.empty) {
        // --- VARSA: PUANI GÃœNCELLE (ÃœSTÃœNE EKLE) ---
        const existingDoc = querySnapshot.docs[0]; // KullanÄ±cÄ±nÄ±n belgesini bul
        const userDocRef = doc(db, "scores", existingDoc.id);

        await updateDoc(userDocRef, {
          score: increment(newScore), // Eski puanÄ±n Ã¼stÃ¼ne ekler
          lastGame: gameName,
          lastPlayedDate: new Date()
        });
        alert(`Tebrikler! Toplam puanÄ±na +${newScore} eklendi. ğŸš€`);

      } else {
        // --- YOKSA: YENÄ° KAYIT OLUÅTUR ---
        await addDoc(scoresRef, {
          name: user.name,
          email: user.email,
          photo: user.photo,
          score: newScore,
          lastGame: gameName,
          lastPlayedDate: new Date()
        });
        alert(`Ä°lk puanÄ±n kaydedildi: ${newScore} Puan! ğŸ†`);
      }

    } catch (e) {
      console.error("Hata:", e);
      alert("Bir hata oluÅŸtu, puan kaydedilemedi.");
    }
  };
</script>
</body>
</html>